---
title: "ELIMINACJE MŒ ROSJA 2018-AMERYKA PO£UDNIOWA"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
data<-read.csv("C:/Users/Agnieszka/Desktop/dane_mecz.csv",h=T,sep=";")
```

Wykorzystane przeze mnie dane pochodz¹ ze stony http://pubsport.pl/mundial-rosja-2018/eliminacje/ameryka-poludniowa/ i dotycz¹ aktualnej sytuacji w tabeli po 10 kolejce eliminacji do Mistrzostw Œwiata 2018.
 
Wykres pierwszy umo¿liwia lepsze poznanie struktury bramek poszczególnych zespo³ów, które mia³y wp³yw na zdobywane przez nie punkty. 
Struktura ta pokazuje, ¿e nie w ka¿dym przypadku dru¿yna z takim samym bilansem bramkowym zdoby³a tyle samo punktów co inna, 
a tak¿e odwrotnie - dru¿yny z t¹ sam¹ liczb¹ punktów maj¹ ró¿ny bilans bramkowy.  

```{r,echo=TRUE,warning=FALSE}
cols <- c("Strzelone"="#44ef61","Stracone"="#f04546","punkty"="black")
ggplot(data,aes(x = DRUZYNA,width=.5)) + 
  geom_bar(stat="identity",aes(y=GOLE_STRZELONE+GOLE_STRACONE,fill="Strzelone")) +
  geom_bar(stat="identity",aes(y=GOLE_STRACONE,fill="Stracone"))+
  scale_fill_manual(name="Bramki",values=cols)+
  scale_color_manual(name="",values=cols)+
  geom_point(aes(y=PKT,color="punkty"))+
  geom_text(aes(y=PKT,label=PKT),hjust=1, vjust=1)+
  ylab("Bramki")+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

W drugim wykresie poznajemy liczbê wygranych, remisów i pora¿ek w dotychczas rozegranych meczach, za które odpowiednio przyznawane s¹ punkty - kolejne 3,1 i 0. 
Przyk³adowo Brazylia która straci³a tyle samo bramek co Argentyna ma lepszy stosunek wygranych do remisów i pora¿ek, co po wyliczeniu skutkuje ró¿nic¹ wynosz¹c¹ 5 pkt na korzyœæ Brazylijczyków.

```{r,echo=TRUE,warning=FALSE}
cols2 <- c("Wygrana"="#44ef61","Remis"="#efe444","Przegrana"="#f04546")
ggplot(data,aes(x = DRUZYNA,width=.5)) + 
  geom_bar(stat="identity",aes(y=W+R+P,fill="Wygrana")) +
  geom_bar(stat="identity",aes(y=R+P,fill="Remis"))+
  geom_bar(stat="identity",aes(y=P,fill="Przegrana"))+
  scale_fill_manual(name="Rezultat",values=cols2)+
  ylab("Liczba meczów")+
  scale_y_continuous("Liczba meczów", c(0,2,4,6,8,10))+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

